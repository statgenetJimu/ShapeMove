ver4.0(今使っているversion)のマニュアル
http://www.torontomicrofluidics.ca/cms/manuals/niselements.pdf

ROIの自動検出(マニュアルP99)
[ROI]、[Simple ROI editor] [Edit ROIs in Time](P98 6.5.5)で使える。
[Simple ROI editor]で出てきたツールバー中の[Auto Detect All]をクリックするとROIの一斉検出ができる。
左クリックをするとその場所を含むROIができる。右クリックで決定。
決定したROIは掴んで動かせる。
マウスホイールをスクロール(もしくはPage up,Page down)することでROIの範囲を調節することができる。Cで凹部をなめらかにし、Oで凸部をなめらかにできる。SもしくはPで分割することができる(基準はよく分からない)。

ROIをBinaryに変える
[ROI]->[Swap Binary with ROI]でできる。ただし実行時に表示されているフレームに対してしか出来ない。

ROIをpngファイルで出力する
[ROI]->[Save ROI As]でファイルの種類としてpngを選ぶ。

ROIの自動追跡
Tracking(P160 9.18)
[View]->[Analysis Contorols]->[Tracking]
[Tracikng]コントロールウィンドウを使えば生きている細胞など動くものを自動で測定できる。
[Define New ROI](Trackingウィンドウ左上）でSimple ROI Editorのツールバーが開き、ROIが作成できる。作成したROIの情報はTrackingウィンドウに読み込まれる。ツールバーを消すとTrackingウィンドウが操作できるようになる。[Track Autodetected ROIs]でROIの追跡が始まる。
ROIが大きく動く場合はROIの追跡画面が止まることがある。その時は、ドラッグできる点があるのでそれをROIで囲みたい対象の異動先に持って行って[Track Autodetected ROIs]をクリックすればまた追跡が再開する。
出力したいROIを選択した状態で[Export](Trackingウィンドウ右上)->[Data to Excel]でExcelにデータを出力できる。
画面にROIが反映されている状態で[File]->[Save As]でROIの情報付きnd2ファイルが出力できる。

３次元画像の表示
[View]->[Image]->[Volume View](もしくは画像ウィンドウの虫眼鏡っぽいマーク)で表示できる。

動くROIを設定する
作成したROIを右クリックして、ROIs change over Timeにチェックを入れる（ROIs are Globalだと動画中動かないROIが設定される）。動画を動かして対象がROIから出るようであれば、動画を止めてROIを動かす。同様の作業を繰り返す。ROIの位置に変更を加えたフレーム間ではROIは等速で動く。軌跡はスムージングされている。

Edit ROI in time
[Edit ROIs in time]コマンドから行う。このコマンドは右のimage toolbarの[Turn ROI on/off]ボタンのcontextual menuからアクセスできると書いてあったが、contextual menuの中にそんなものはなかった。Local Optionが入っていないのが原因?([Tracking]と[Local Option]が必要らしい(p98))

Local Option
Edit ROIs in Timeなどに必要。
NIS-Elementをインストールするときにインストールするかどうか選択できる(P2)。後からインストールする場合は[Start menu > Programs > NIS-Elements AR]に行き、[Modify installation]コマンドを選び、installation wizardの指示に従って加えたいアイテムのチェックボックスをオンにして、インストールを終える。

_ND_Export
Exportしたいnd2ファイルを開いた状態でコマンドラインを開き、”c:¥program Files¥NIS-Elements¥nis_ar.exe” -c “_ND_Export();”と打って実行すると出力用ウィンドウが開く。
[File]->[Import/Export]->[Export ND Document]でも出力用ウィンドウは開く。”_ND_ExportToTIFF();”コマンドというのもあるらしいが使えなかった（原因不明）。
ND Exportの時にInsert Overlaysにチェックを入れると出力された画像にROIも出力される。ただ、そのまま出力すると出力ファイルにはROIのラベルと移動の軌跡も一緒に出力されてしまう。
ROIのラベル番号はROIを右クリックして[ROI properties]を開き、Show Labelsのチェックを外せば消える。
軌跡を消すにはTrackingウィンドウを開いて目的のROIを右クリックし、[Unselect All]を選ぶ。すると、軌跡と中の塗りつぶしが消える。
中に中心を表す十字マークが表示されているようであればそれも消す必要がある。方法は歯車のマークをクリックし、Tracking Optionsが開く。[Display]タブをクリックし、[Show centroid]のチェックを外し、また下に5つ並んでいるチェックボックスのうち[Show only selected tracks]のみが選択された状態にする。
バイナリ化は[Binary]->[Define Threshold]でDifine Thresholdウィンドウを開いて、Saveコマンドの左にあるFull Image/Use ROIコマンド(ROIのマーク)をクリックして有効にする。(これで再生をすると警告が出るが意味がよくわからなかったのでYesを選択した。今の所問題は出ていない。)画像ウィンドウの右に並んでいるコマンドから[Turn ROI On/Off](ROIのマーク)を選んでをEnable Dynamic Threshold(画像ウィンドウ中の上に並んでいるアイコンの一つ)を押してもできる。ROI内とROIの輪郭の色が異なるのが気になる場合はROIを右クリックして[ROI Properties]から輪郭の色を赤に変えれば良い。変更はROI Propertiesにある上の方の色指定部分からできる。
バイナリ化を各フレームごとに行うためにはThresholdを動画ファイルに適用している段階でPreviewのチェックボックスをOnにしておく必要がある。チェックボックスがOnになっているフレームでのみROIが更新されるので、一番初めに作業をする際はあらかじめ別の画像ファイルを使うなどしてチェックボックスをOnにしておく必要がある。

ZT変換
変換したいファイルを一度[File]->[Import/Export]->[Export ND Document]でTIFかjpegに変換する(jpegへの変換は非常に時間が掛かる)。この時に出てきたウィンドウのIndex orderをt,zの並びからz,t変える。次に[File]->[Open]で先ほど変換したファイルの中一枚を選ぼうとすると「この画像を含む一連のデータをND Documentに変換するか？」とダイアログボックスが出てくるので[Convert]を選択。Define Manuallyを選択した状態で下のTime、Z seriesの順にして読み込むとデータラベルが逆転する。開いたファイルを[File]->[Save As]から保存すればZとTが入れ替わったnd2の動画データができる。
